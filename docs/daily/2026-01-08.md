# 2026-01-08 (수) 일일 작업 로그

## 완료된 작업

### 1. DataStoreService TrackingCMD 실시간 업데이트 버그 수정

| 항목 | 내용 |
|------|------|
| 유형 | Bugfix |
| 파일 | `backend/src/main/kotlin/.../service/datastore/DataStoreService.kt` |

**Why**: TRACKING 상태에서 `shouldPreserveCmdValue` 로직이 UDP 하드웨어 값을 차단하여 TrackingCMD가 고정값으로 표시되던 문제 해결.

**변경 내용:**
- `shouldPreserveCmdValue` 조건 제거 - UDP 하드웨어 값 즉시 반영
- `forceUpdate` 파라미터 제거 (불필요해짐)
- 39줄 제거, 코드 단순화

### 2. EphemerisService forceUpdate 파라미터 제거

| 항목 | 내용 |
|------|------|
| 유형 | Refactor |
| 파일 | `backend/src/main/kotlin/.../service/mode/EphemerisService.kt` |

**Why**: DataStoreService에서 `forceUpdate` 파라미터가 제거됨에 따라 연관 호출 정리.

### 3. ICDService 디버그 로깅 제거

| 항목 | 내용 |
|------|------|
| 유형 | Cleanup |
| 파일 | `backend/src/main/kotlin/.../service/icd/ICDService.kt` |

**Why**: 개발 중 추가했던 5초 간격 Tracking CMD 로깅 코드 제거 (프로덕션 불필요).

### 4. ICDService trackingCMD offset 복원

| 항목 | 내용 |
|------|------|
| 유형 | Bugfix |
| 파일 | `backend/src/main/kotlin/.../service/icd/ICDService.kt` |

**Why**: 이전에 제거되었던 trackingCMD offset 적용 로직을 복원. 하드웨어에서 받은 CMD 값에 position offset을 적용해야 프론트엔드에서 올바른 값이 표시됨.

**변경 내용:**
```kotlin
trackingCMDAzimuthAngle = it.trackingCMDAzimuthAngle + GlobalData.Offset.azimuthPositionOffset
trackingCMDElevationAngle = it.trackingCMDElevationAngle + GlobalData.Offset.elevationPositionOffset
trackingCMDTrainAngle = it.trackingCMDTiltAngle + GlobalData.Offset.trainPositionOffset + GlobalData.Offset.trueNorthOffset
```

### 5. PassSchedule 오버랩 선택 버그 수정

| 항목 | 내용 |
|------|------|
| 유형 | Bugfix (Critical) |
| 파일 | `frontend/src/components/content/SelectScheduleContent.vue` |

**Why**: 시간이 겹치는 스케줄들이 동시에 선택 가능했던 버그 수정.

**버그 원인 분석:**
1. **1차 문제**: `overlappingGroups`가 `schedule.no` 사용 - 정렬 후 재할당되는 UI 인덱스
2. **2차 문제**: q-table `v-model:selected` 양방향 바인딩 - 행 클릭 시 검증 우회

**수정 내용:**
- 오버랩 체크 기준을 `no` → `mstId`로 변경 (안정적인 고유 ID)
- `v-model:selected` → `:selected` + `@update:selected` 분리
- `handleSelectionUpdate()` 함수 추가 - 모든 선택에 검증 적용
- 184줄 변경 (+136, -110)

---

## 커밋 목록

| 시간 | 커밋 | 메시지 |
|------|------|--------|
| - | d3140ca | fix(passschedule): 오버랩 스케줄 중복 선택 버그 수정 |
| - | (예정) | fix(icd): trackingCMD offset 적용 복원 |

---

## 기술 세부사항

### PassSchedule MstId 구조 정리

```
SatelliteID: 위성 카탈로그 번호 (예: "25544" ISS)
MstId: 패스별 전역 시퀀스 인덱스 (모든 위성에 걸쳐 1, 2, 3...)
DetailId: 패스 내 시간 포인트 인덱스
no: UI 표시용 인덱스 (정렬 후 재할당됨 - 검증에 사용 불가)
```

### q-table 선택 검증 흐름

```
[Before] 체크박스 클릭 → handleCheckboxChange() → 검증 O
         행 클릭 → v-model 직접 수정 → 검증 X (버그)

[After]  체크박스/행 클릭 → @update:selected → handleSelectionUpdate() → 검증 O
```

---

**작성**: Claude Code
**시간**: 2026-01-08
