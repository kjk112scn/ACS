# ACS 시스템 고도화 비전

> **버전**: 0.3.0 | **작성일**: 2026-01-13
> **상태**: 요구사항 확정 완료

---

## 1. 비전 (Vision)

### 우리가 원하는 최종 상태

```
ACS v2.0: 글로벌 납품 가능한 안테나 제어 시스템
├── 안정적인 데이터 영속성 (DB) - 추적 데이터 포함
├── 체계적인 로깅/모니터링
├── 완전한 다국어 지원 (한/영)
├── 외부 시스템 연동 (API 인증)
├── 일관된 코드 품질
└── 완전한 문서화
```

### 핵심 목표

| 목표 | 현재 | 목표 상태 |
|------|------|----------|
| **추적 데이터 영속성** | RAM (휘발성) | **PostgreSQL 저장** (P0) |
| **외부 시스템 인증** | 없음 | **API Key + JWT** (P0) |
| **다국어** | FE만 완료 | **FE 유지 (BE 불필요)** |
| **로깅** | 분산, 비체계적 | 구조화된 파일 로깅 |
| **테스트** | 1.5% 커버리지 | 50%+ 커버리지 |
| **코드 품질** | 대형 파일, 중복 | 모듈화, DRY |
| **문서화** | 부분적 | 코드↔문서 동기화 |
| **배포** | 수동 | 설치 스크립트 (Docker는 추후) |

---

## 2. 현황 분석 (As-Is)

### 2.1 데이터 관리

| 영역 | 현재 상태 | 문제점 |
|------|----------|--------|
| 설정 데이터 | DB 지원 (with-db 프로필) | 기본이 no-db |
| 추적 데이터 | 메모리 (Map) | 재시작 시 소실 |
| 로그 데이터 | 파일 기반 | 검색/분석 어려움 |
| 세션 데이터 | 메모리 | 다중 인스턴스 불가 |

### 2.2 로깅 시스템

| 영역 | 현재 상태 | 문제점 |
|------|----------|--------|
| 로그 포맷 | 텍스트 기반 | 파싱 어려움 |
| 로그 레벨 | 서비스별 혼재 | 일관성 없음 |
| 로그 저장 | 파일 분리 | 검색 어려움 |
| 비즈니스 로그 | 없음 | 추적 불가 |

### 2.3 코드 구조

| 영역 | 현재 상태 | 문제점 |
|------|----------|--------|
| BE 서비스 | 5,000줄+ 파일 존재 | 유지보수 어려움 |
| FE 페이지 | 4,800줄+ 파일 존재 | 유지보수 어려움 |
| 상태 머신 | 40% 중복 | DRY 위반 |
| API 응답 | 3가지 형식 | 일관성 없음 |

### 2.4 인프라

| 영역 | 현재 상태 | 문제점 |
|------|----------|--------|
| CI/CD | 없음 | 수동 배포 |
| 테스트 | 거의 없음 | 리팩토링 위험 |
| 보안 | 없음 | 인증/인가 없음 |
| 모니터링 | 기본적 | 알림 없음 |

---

## 3. 영역별 RFC 목록

### 필요한 RFC 문서

| RFC# | 제목 | 우선순위 | 상태 |
|------|------|----------|------|
| RFC-001 | 데이터베이스 전략 | P0 | **작성 완료** (v1.1.0) |
| RFC-002 | 로깅 시스템 고도화 | P0 | **작성 완료** (v1.0.0) |
| RFC-003 | 상태 머신 추출 | **P2** | 점진적 개선 (격하) |
| RFC-004 | API 표준화 | P1 | **작성 완료** (v1.0.0) |
| RFC-005 | 테스트 전략 | **P2** | 나중에 진행 (격하) |
| RFC-006 | CI/CD 파이프라인 | P1 | 작성 필요 |
| RFC-007 | 보안 인증/인가 | P2 | 작성 필요 |
| RFC-008 | 프론트엔드 구조화 | P2 | 작성 필요 |

---

## 4. 우선순위 결정 기준

### 의존성 분석

```
[RFC-001 DB 전략] ──────────────────┐
         │                         │
         ▼                         ▼
[RFC-002 로깅]              [RFC-003 상태머신]
         │                         │
         ▼                         ▼
[RFC-005 테스트] ◄────────► [RFC-004 API 표준화]
         │
         ▼
[RFC-006 CI/CD] ──► [RFC-007 보안]
                          │
                          ▼
                   [RFC-008 FE 구조화]
```

### 권장 순서

1. **Phase 0**: RFC-001 (DB) - 모든 것의 기반
2. **Phase 1**: RFC-002 (로깅) + RFC-003 (상태머신) - 병렬 진행 가능
3. **Phase 2**: RFC-004 (API) + RFC-005 (테스트) - 품질 기반
4. **Phase 3**: RFC-006 (CI/CD) + RFC-007 (보안) - 운영 준비
5. **Phase 4**: RFC-008 (FE 구조화) - 마무리

---

## 5. 성공 기준

### 정량적 목표

| 지표 | 현재 | 목표 | 측정 방법 |
|------|------|------|----------|
| 테스트 커버리지 | 1.5% | 50% | ./gradlew test |
| 최대 파일 크기 | 5,057줄 | 2,000줄 | wc -l |
| 코드 중복률 | 40% | 10% | 수동 검토 |
| 빌드 시간 | ? | 2분 이내 | CI 측정 |
| API 응답 형식 | 3가지 | 1가지 | 코드 검토 |

### 정성적 목표

- [ ] 재시작 후에도 데이터 유지
- [ ] 로그로 문제 원인 추적 가능
- [ ] 새 개발자가 1일 내 개발 시작 가능
- [ ] 코드 변경 시 자동 테스트 실행
- [ ] 문서가 코드와 동기화됨

---

## 6. 다음 단계

### 즉시 작성할 RFC

1. **RFC-001: 데이터베이스 전략**
   - 어떤 데이터를 DB에 저장할 것인가?
   - 스키마 설계
   - 마이그레이션 전략

2. **RFC-002: 로깅 시스템 고도화**
   - 로그 카테고리 정의
   - 구조화된 로깅 (JSON)
   - 로그 레벨 표준

### 작성 템플릿

각 RFC는 다음 구조로 작성:

```markdown
# RFC-XXX: 제목

## 배경 (Context)
왜 이 변경이 필요한가?

## 현재 상태 (Current State)
지금은 어떻게 되어 있는가?

## 제안 (Proposal)
무엇을 어떻게 바꿀 것인가?

## 대안 (Alternatives)
다른 방법은 없었는가?

## 영향 분석 (Impact)
무엇이 변경되는가?

## 마이그레이션 (Migration)
기존 시스템은 어떻게 전환하는가?

## 검증 (Verification)
어떻게 성공을 확인하는가?
```

---

## 7. 결정 사항 (Decisions)

### 확정된 사항

| 영역 | 질문 | 결정 | 비고 |
|------|------|------|------|
| **DB** | 어떤 DB? | PostgreSQL + **TimescaleDB** | 시계열 최적화 확장 |
| **DB** | 추적 데이터 저장? | **예 (P0)** | 제일 중요한 요구사항 |
| **로깅** | 외부 시스템 (ELK)? | 아니오 | 파일 로깅으로 충분 |
| **배포** | Docker 사용? | **추후 검토** | 안정화 후 도입 고려 |
| **보안** | 인증 방식? | **API Key + JWT** | 외부 시스템 연동 필수 |
| **다국어** | BE 런타임 i18n? | **아니오** | FE만 충분, BE는 불필요 |

### 추가 확정 사항 (2026-01-13)

| 영역 | 질문 | 결정 | 비고 |
|------|------|------|------|
| **DB** | 추적 데이터 보관 기간? | **30일** | TimescaleDB 자동 삭제 |
| **DB** | 실시간 ICD 데이터? | **30일 보관** | 100ms 전체 저장 + 압축 |
| **DB** | TLE 데이터 보관? | **영구 보관** | 용량 무시 가능 (~1MB/년) |
| **백업** | CSV 별도 저장? | **제거** | DB export API로 대체 |
| **로그** | 로그 보관 기간? | **30일** | Logback 롤링 + 5GB 캡 |
| **보안** | 역할(Role) 구분? | **3단계** | Admin/Supervisor/Observer |
| **상태머신** | RFC-003 우선순위? | **P2 격하** | 점진적 개선, SunTrack 별도 유지 |

### 용량 관리 정책 (512GB 기준)

| 데이터 유형 | 보관 기간 | 삭제 방식 | 예상 용량 |
|------------|----------|----------|----------|
| 실시간 ICD (DB) | 30일 | TimescaleDB 자동 | **~2.6GB** (압축 후) |
| 추적 데이터 (DB) | 30일 | TimescaleDB 자동 | ~15MB |
| TLE 데이터 (DB) | 영구 | 삭제 안 함 | ~1MB/년 |
| 로그 파일 | 30일 | Logback 롤링 | ~5GB (캡) |
| **합계** | - | - | **~7.6GB** (1.5%) |

> **TimescaleDB 압축**: 100ms 전체 저장 (26GB) → 압축 후 ~2.6GB (90% 절약)
> **로그 용량**: 운영 후 모니터링하며 조정 예정

---

## 8. 글로벌 납품 고려사항

### Docker 도입 시점

```
현재 (2026-01)     →     안정화 후 (2026-Q2)     →     납품 시 (필요 시)
     │                         │                           │
     ▼                         ▼                           ▼
 설치 스크립트            Docker 이미지 생성         고객 환경에 따라 선택
 (install.sh)           (Dockerfile 작성)         (Docker or 직접 설치)
```

### 다국어 현황 (확정)

| 영역 | 현재 | 결정 |
|------|------|------|
| FE UI | 한/영 완료 | **유지** (충분함) |
| BE API 문서 | 한/영 완료 | **유지** |
| BE 에러 메시지 | 하드코딩 맵 | **현상 유지** (복잡도 증가 불필요) |
| BE 응답 메시지 | 한국어 | **현상 유지** |

> **결론**: FE에서 이미 i18n 완료되어 있으므로 BE 추가 작업 불필요

---

**작성자**: Claude
**상태**: 요구사항 확정 완료
**다음 작업**: RFC-001 (DB 전략 - 추적 데이터 30일 보관 + 롤링 삭제) 작성
