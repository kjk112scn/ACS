---
name: bugfix
description: 버그 수정 워크플로우. 원인 분석, 수정 계획, 회귀 테스트까지 체계적 버그 해결. "버그 수정", "에러 해결", "bugfix", "오류", "문제 해결" 키워드에 반응.
model: opus
---

# Bugfix - 버그 수정 스킬 (v2.2)

> **v2.2 변경**: 승인 절차 명시화, FIX.md 통합 방식, 상세 템플릿 포함

## 역할

버그 수정의 전체 라이프사이클을 체계적으로 관리합니다.

**핵심 가치:**
- 체계적 원인 분석 (ANALYSIS.md)
- **명시적 승인 후 구현** (사용자 확인 필수)
- FIX.md 통합 관리 (시간순 섹션)
- 관련 아카이브 자동 검색

---

## 워크플로우

```
[1. 검색] → [2. 분석] → [3. 문서] → [4. 요약] → [5. 승인] → [6. 구현] → [7. 완료]
     │           │          │          │          │          │          │
  archive/   ANALYSIS.md  FIX.md    사용자에게   "진행      코드      /done
  검색       원인 분석    섹션 추가  표로 요약    할까요?"   수정      호출
```

**⚠️ 중요: 5단계(승인) 전까지는 코드 수정 금지!**

---

## 실행 단계

### Step 1: 관련 아카이브 검색 (자동)

```yaml
동작:
  - 버그 키워드로 archive/ 검색
  - 관련 과거 문서 발견 시 참조 제안

예시:
  "📦 관련 archive 발견: Login_Token_Expire_Bugfix
   참고할까요? [y/n]"
```

### Step 2: 폴더 확인/생성

```yaml
판단:
  1. docs/work/active/ 에서 관련 작업 폴더 검색
  2. 있으면 → 해당 폴더의 FIX.md에 섹션 추가
  3. 없으면 → 새 폴더 생성

규칙: 기존 작업 폴더 사용 우선 (파일 분리 최소화)
```

**폴더 구조:**
```
docs/work/active/Bugfix_{버그명}/
├── README.md      # 버그 정보
├── ANALYSIS.md    # 원인 분석
└── FIX.md         # 수정 내용 (시간순 섹션)
```

### Step 3: 원인 분석 (ANALYSIS.md)

**에이전트 호출:**
- `debugger`: 원인 분석, 데이터 흐름 추적
- `tech-lead`: 영향 범위 검토 (필요시)

**ANALYSIS.md 템플릿:**

```markdown
# {버그명} 원인 분석

## 1. 증상

{버그 증상 설명}

## 2. 재현 단계

1. ...
2. ...
3. ...

## 3. 분석 과정

### 로그 분석
```
{관련 로그 또는 에러 메시지}
```

### 코드 추적
| 순서 | 파일 | 함수 | 설명 |
|------|------|------|------|
| 1 | | | |

### 데이터 흐름
```
{입력} → [처리 1] → [처리 2] → {문제 발생 지점}
```

## 4. 근본 원인 (Root Cause)

**원인**: {왜 이 버그가 발생했는가}

**Why 분석 (5 Whys):**
1. Why? →
2. Why? →
3. Why? →
4. Why? →
5. Why? → **근본 원인**

## 5. 영향 범위

| 영역 | 영향 | 설명 |
|------|:----:|------|
| Frontend | ✅/❌ | |
| Backend | ✅/❌ | |
| Algorithm | ✅/❌ | |

## 6. 관련 파일

| 파일 | 역할 | 수정 필요 |
|------|------|:--------:|
| | | ✅/❌ |
```

### Step 4: 문서 정리 (FIX.md)

**FIX.md 섹션 템플릿** (기존 파일에 섹션 추가):

```markdown
---

## YYYY-MM-DD: {버그 제목}

| 항목 | 내용 |
|------|------|
| **심각도** | 🔴 Critical / 🟠 High / 🟡 Medium / 🟢 Low |
| **상태** | 🔧 수정중 |

### 증상

{문제 현상}

### 원인

{Root Cause}

### 수정 방안

**선택한 방안**: {어떻게 수정할 것인가}

#### 대안 비교
| 방안 | 장점 | 단점 | 선택 |
|------|------|------|:----:|
| A | | | ❌ |
| B | | | ✅ |

### 변경 내용

#### {파일명}
```diff
- 변경 전
+ 변경 후
```

**Why**: {왜 이렇게 수정했는가}

### 테스트 계획

#### 수정 확인
- [ ] 버그 증상 해결 확인
- [ ] 재현 단계 다시 실행

#### 회귀 테스트
- [ ] 관련 기능 정상 작동
- [ ] 다른 기능 영향 없음
- [ ] 빌드 성공

### 재발 방지

| 대책 | 적용 |
|------|:----:|
| 입력 검증 강화 | ✅/❌ |
| 테스트 추가 | ✅/❌ |
```

### Step 5: 요약 보고 + 승인 요청

**사용자에게 표 형식으로 요약 후 명시적 승인 요청:**

```markdown
## 버그 분석 완료

| 항목 | 내용 |
|------|------|
| **문제** | {1줄 요약} |
| **원인** | {Root Cause} |
| **심각도** | 🔴/🟠/🟡/🟢 |
| **수정 파일** | {파일 목록} |

### 수정 계획
- 파일1: {변경 내용 요약}
- 파일2: {변경 내용 요약}

**수정을 진행할까요?**
```

**⚠️ 승인 전까지 코드 수정 금지!**

### Step 6: 구현 (승인 후)

```yaml
승인 후:
  - 코드 수정 진행
  - PROGRESS.md 실시간 업데이트
  - 빌드 검증

완료 시:
  - FIX.md 상태 → ✅ 수정 완료
  - PROGRESS.md 업데이트
```

### Step 7: 완료 처리

**자동 호출:** `/done` 스킬 (필요시)

---

## 심각도 분류

| 레벨 | 이모지 | 기준 | 대응 |
|------|:------:|------|------|
| Critical | 🔴 | 시스템 다운, 데이터 손실 | 즉시 |
| High | 🟠 | 주요 기능 불가 | 당일 |
| Medium | 🟡 | 기능 제한, 우회 가능 | 이번 주 |
| Low | 🟢 | 경미한 불편 | 백로그 |

---

## 호출 에이전트

| 에이전트 | 역할 | 호출 시점 |
|---------|------|---------|
| `debugger` | 원인 분석 | Step 3 |
| `tech-lead` | 영향 범위 검토 | Step 3 (필요시) |
| `be-expert` | Backend 수정 | Step 6 |
| `fe-expert` | Frontend 수정 | Step 6 |
| `test-expert` | 테스트 실행 | Step 6 |
| `doc-syncer` | 문서 동기화 | Step 7 |

---

## 실행 예시

### 예시 1: 성능 버그

```
사용자: "PassSchedule 차트가 너무 느려"

→ /bugfix 워크플로우 시작:

[Step 1: 아카이브 검색]
  🔍 archive/에서 "PassSchedule" 검색...
  📦 관련 문서 없음 → 새로 시작

[Step 2: 폴더 생성]
  docs/work/active/Bugfix_PassSchedule_Chart_Slow/
  ├── README.md
  ├── ANALYSIS.md
  └── FIX.md

[Step 3: 원인 분석]
  debugger 에이전트 호출
  - 로그 분석: 렌더링 4초
  - 코드 추적: 모든 데이터 매 프레임 재계산
  - Root Cause: 불필요한 computed 재평가

[Step 4: 문서 정리]
  FIX.md 작성
  - 증상, 원인, 수정 방안, 테스트 계획

[Step 5: 요약 + 승인 요청] ⭐
  ## 버그 분석 완료
  | 항목 | 내용 |
  |------|------|
  | **문제** | 차트 렌더링 4초 지연 |
  | **원인** | 불필요한 computed 재평가 |
  | **수정 파일** | ChartComponent.vue |

  **수정을 진행할까요?**

  사용자: "응"

[Step 6: 구현]
  fe-expert 에이전트 호출
  - watchEffect → computed + shallowRef 변경
  - 빌드 검증 ✅

[Step 7: 완료]
  /done 자동 호출
  - FIX.md 상태 → ✅ 수정 완료
  - work/archive/ 이동
```

### 예시 2: 로직 버그 (기존 작업에 추가)

```
사용자: "위성 추적 시 고도각이 음수로 표시돼"

→ /bugfix 워크플로우 시작:

[Step 1: 아카이브 검색]
  📦 관련 문서 없음

[Step 2: 폴더 확인]
  ✅ docs/work/active/Tracking_Schema_Redesign/ 존재
  → 해당 폴더의 FIX.md에 섹션 추가

[Step 3: 원인 분석]
  debugger 에이전트 호출
  - Root Cause: 라디안→도 변환 시 부호 오류

[Step 4: 문서 정리]
  FIX.md에 새 섹션 추가:
  ## 2026-01-23: 고도각 음수 표시 버그
  ...

[Step 5: 요약 + 승인 요청] ⭐
  ## 버그 분석 완료
  | 항목 | 내용 |
  |------|------|
  | **문제** | 고도각 -5° 표시 |
  | **원인** | 라디안→도 변환 부호 오류 |
  | **수정 파일** | CoordinateConverter.kt |

  **수정을 진행할까요?**

[Step 6~7: 승인 후 진행]
```

---

## 트러블슈팅

### Q: 원인을 못 찾겠어요
A: debugger 에이전트에게 더 자세한 로그와 재현 단계 제공. 5 Whys 기법 활용.

### Q: 수정했는데 다른 곳이 망가졌어요
A: FIX.md의 "영향 범위" 재분석. 회귀 테스트 체크리스트 확장.

### Q: 같은 버그가 반복돼요
A: ANALYSIS.md의 "재발 방지 대책" 강화. ADR 생성 검토.

---

## 관련 스킬

- `/revive` - 과거 버그 문서 부활
- `/done` - 작업 완료

---

**스킬 버전:** 2.2.0
**작성일:** 2026-01-23
**변경:** 승인 절차 명시화, 상세 템플릿 통합, 예시에 승인 단계 추가
**호환:** ACS 프로젝트 전용